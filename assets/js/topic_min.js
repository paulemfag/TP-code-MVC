var compteur=0;try{var tiButtons=[],tiClass="ti-connect",useQuerySelector=document.querySelectorAll;if(useQuerySelector)tiButtons=document.querySelectorAll("div."+tiClass+", span."+tiClass);else if(document.getElementsByTagName){var div=document.getElementsByTagName("div"),span=document.getElementsByTagName("span"),result=Array.prototype.slice.call(div).concat(Array.prototype.slice.call(span));if(result)for(var i=0;i<result.length;i++){var currentElement=result[i],elementClass=currentElement.className+"";elementClass.match(new RegExp(tiClass,"i"))&&tiButtons.push(currentElement)}result=null}if(!tiButtons)throw"No TopicIt button found";for(i=0;i<tiButtons.length;i++)_replaceElement(tiButtons[i])}catch(t){console&&console.error("An error occured: "+t)}function _replaceElement(t){try{var e={colorscheme:"light",redirect:document.location.href,lang:"en",loc:t.hasAttribute("data-loc")?t.getAttribute("data-loc"):""},i={colorscheme:/light|dark/i,height:/\d+(\.\d+)?(px|%|pt|em)/i,label:/.+/,lang:/[a-z]{2}/i,loc:/^(https?:)?\/\/(connect\.)?(topicit\.net|topicit\.1lan\.net)/,login:/^(https?:)?\/\//,redirect:/^(https?:)?\/\//,version:/\d+(\.\d+)?/,width:/\d+(\.\d+)?(px|%|pt|em)/i};for(var n in i){var o=t.hasAttribute("data-"+n)?t.getAttribute("data-"+n):"";""!==o&&o.match(i[n])&&("redirect"==n&&(o=o.replace(/#.+$/,"")),e[n]=o)}var r=e.loc+"button/"+e.colorscheme+"?id=topicit-connect-"+compteur;for(var n in e)switch(n){case"colorscheme":continue;case"width":r=r+"&bw="+e.width;break;case"height":r=r+"&bh="+e.height;break;default:r=r+"&"+n+"="+encodeURIComponent(e[n])}var c=document.createElement("iframe");c.setAttribute("id","topicit-connect-"+compteur),c.setAttribute("class","topicit-connect-button"),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","no"),c.setAttribute("allowtransparency","true"),c.setAttribute("style","position:static;visibility:visible;width:100px;height:30px;"),c.setAttribute("title","TopicIt Connect Button"),c.setAttribute("src",r),compteur++,t.appendChild(c)}catch(t){console&&console.error("An error occured: "+t)}}function topicit_action(t){if("https://topicit.1lan.net"===t.origin||"https://topicit.net"===t.origin||"https://connect.topicit.1lan.net"===t.origin||"https://connect.topicit.net"===t.origin){var e=t.data.action||"";if("connect-button"===e&&t.data.id){var i=t.data.dimensions||{};if(i.height||(i.height=0),i.width||(i.width=0),isInt(i.height)&&isInt(i.width)){var n=i.height+"",o=i.width+"",r=document.getElementById(t.data.id);r&&(r.style.height=n.trim()+"px",r.style.width=o.trim()+"px")}}"redirect"===e&&t.data.url&&(window.location.href=t.data.url)}}function isInt(t){var e;return!isNaN(t)&&(0|(e=parseFloat(t)))===e}window.addEventListener?window.addEventListener("message",topicit_action,!1):window.attachEvent&&window.attachEvent("onmessage",topicit_action);